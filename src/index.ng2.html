<!doctype html>
<html lang="en">
<head>
  <title>Isomorphic Angular 2</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="css/main.css" media="screen" title="no title" charset="utf-8">
</head>
<body>

  <todo-app></todo-app>

  <!-- remain server rendered -->
  <todo-app></todo-app>


</body>

<!-- ES6-related imports -->
<script src="lib/traceur-runtime.js"></script>
<script src="lib/es6-module-loader-sans-promises.src.js"></script>
<script src="lib/extension-register.js"></script>
<script>
  window.global = window.global || window;
  window.register(System);
</script>
<!-- Angular2-related imports -->
<!-- // <script src="lib/rtts_assert.js"></script> -->
<script src="lib/angular2.js"></script>
<script src="lib/zone.js"></script>
<!-- Application bootstrap logic -->
<!-- <script src="app.js"></script> -->
<script>
  Promise.all([
    System.import('angular2/core'),
    System.import('angular2/di'),
    System.import('angular2/src/core/compiler/shadow_dom_strategy'),
    System.import('app.es6')
  ])
  .then(function(modules) {
    var ng2 = modules[0];
    var di = modules[1];
    var dom = modules[2];
    var cmp = modules[3];
    return new Promise(function(resolve) {
      var bindings = [];
      if (!!document.body.createShadowRoot) {
        bindings.push(
          di.bind(dom.ShadowDomStrategy).toClass(dom.NativeShadowDomStrategy)
        );
      }
      // because angular2 bootstraps too fast
      var timer = 1000000;
      setTimeout(function() {
        resolve(
          ng2.bootstrap(cmp.TodoApp, bindings)
        );
      }, timer);
    });
    // return modules[0].bootstrap(modules[1].App);
  })
  .catch(console.log.bind(console));

</script>
<!-- End Application bootstrap logic -->

</html>
