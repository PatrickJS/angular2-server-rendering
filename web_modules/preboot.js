!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.preboot=e()}}(function(){return function e(t,n,o){function r(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return r(n?n:e)},d,d.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({"./freeze/freeze_with_spinner.js":[function(e,t,n){function o(e){var t=e.freezeStyles||{},n=t.overlay||{},o=t.spinner||{};s.overlay=i.addNodeToBody("div",n.className,n.style),s.spinner=i.addNodeToBody("div",o.className,o.style),i.on(e.freezeEvent,function(e){s.spinner.top=e.target.offsetTop,s.spinner.left=e.target.offsetLeft,s.overlay.style.display="block",s.spinner.style.display="block",setTimeout(function(){s.overlay&&(s.overlay.style.display="none"),s.spinner&&(s.spinner.style.display="none")},4e3)})}function r(){i.removeNode(s.overlay),i.removeNode(s.spinner),s.overlay=null,s.spinner=null}var i=e("../dom"),s={overlay:null,spinner:null};t.exports={state:s,prep:o,cleanup:r}},{"../dom":2}],"./listen/listen_by_selectors.js":[function(e,t,n){function o(e){var t,n,o,i,s,a,l,u=[],d=e.eventsBySelector||{},p=Object.keys(d);for(t=0;t<p.length;t++)if(n=p[t],l=d[n],i=r.getAllAppNodes(n))for(s=0;s<i.length;s++)for(o=i[s],a=0;a<l.length;a++)u.push({node:o,eventName:l[a]});return u}var r=e("../dom");t.exports={getNodeEvents:o}},{"../dom":2}],"./replay/replay_after_rerender.js":[function(e,t,n){function o(e,t,n){var o,i,s,a,l,u=[];for(e=e||[],o=0;o<e.length;o++)i=e[o],l=i.event,s=i.node,a=r.findClientNode(s),a?(a.value=s.value,a.dispatchEvent(l),n(3,s,a,l)):(n(4,s),u.push(i));return u}var r=e("../dom");t.exports={replayEvents:o}},{"../dom":2}],1:[function(e,t,n){function o(){var e=i.state.appRoot,t=e.cloneNode(!1);t.style.display="none",e.parentNode.insertBefore(t,e),i.updateRoots(e,e,t)}function r(){var e=i.state.clientRoot||i.state.appRoot,t=i.state.serverRoot||i.state.appRoot;s.switched||(t!==e&&"BODY"!==t.nodeName&&(t.remove?t.remove():t.style.display="none"),e.style.display="block",i.updateRoots(e,null,e),s.switched=!0)}var i=e("../dom"),s={switched:!1};t.exports={state:s,prep:o,switchBuffer:r}},{"../dom":2}],2:[function(e,t,n){function o(e){h.window=e.window||h.window||{},h.document=e.document||h.window.document||{},h.body=e.body||h.document.body,h.appRoot=e.appRoot||h.body,h.serverRoot=h.clientRoot=h.appRoot}function r(e,t,n){h.appRoot=e,h.serverRoot=t,h.clientRoot=n}function i(e){return h.document.querySelector(e)}function s(e){return h.appRoot.querySelector(e)}function a(e){return h.appRoot.querySelectorAll(e)}function l(e){return h.clientRoot.querySelectorAll(e)}function u(e){h.window.addEventListener("load",e)}function d(e,t){h.document.addEventListener(e,t)}function p(e){h.document.dispatchEvent(new h.window.Event(e))}function f(e,t){e.dispatchEvent(new h.window.Event(t))}function c(e){return h.appRoot.contains(e)}function v(e,t,n){var o=h.document.createElement(e);if(o.className=t,n)for(var r in n)n.hasOwnProperty(r)&&(o.style[r]=n[r]);return h.body.appendChild(o)}function y(e){e.remove?e.remove():e.style.display="none"}function m(e,t){for(var n=[],o=e;o&&o!==t;)n.push(o),o=o.parentNode;o&&n.push(o);var r,i,s=e.nodeName,a=n.length;for(r=a-1;r>=0;r--)if(o=n[r],o.childNodes&&r>0)for(i=0;i<o.childNodes.length;i++)if(o.childNodes[i]===n[r-1]){s+="_s"+(i+1);break}return s}function g(e){if(!e)return null;for(var t=m(e,h.serverRoot),n=N[t]||[],o=0;o<n.length;o++)if(n[o].serverNode===e)return n[o].clientNode;var r=e.tagName,i=(e.className||"").replace("ng-binding","").trim();e.id?r+="#"+e.id:i&&(r+="."+i.replace(/ /g,"."));var s=l(r);for(o=0;s&&o<s.length;o++){var a=s[o];if(m(a,h.clientRoot)===t)return N[t]=N[t]||[],N[t].push({clientNode:a,serverNode:e}),a}return null}var h={},N={};t.exports={state:h,nodeCache:N,init:o,updateRoots:r,getDocumentNode:i,getAppNode:s,getAllAppNodes:a,getClientNodes:l,onLoad:u,on:d,dispatchGlobalEvent:p,dispatchNodeEvent:f,appContains:c,addNodeToBody:v,removeNode:y,getNodeKey:m,findClientNode:g}},{}],3:[function(e,t,n){function o(e,t,n){return function(o){u.listening&&(e.preventDefault&&o.preventDefault(),e.dispatchEvent&&l.dispatchGlobalEvent(e.dispatchEvent),e.action&&e.action(t,o,l),e.trackFocus&&(u.activeNode="focusin"===o.type?o.target:null),"keyup"===n&&13===o.which&&t.attributes["(keyup.enter)"]&&l.dispatchGlobalEvent("PrebootFreeze"),e.doNotReplay||u.events.push({node:t,event:o,name:n,time:(new Date).getTime()}))}}function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=r.node,s=r.eventName,a=o(t,i,s);i.addEventListener(s,a),u.eventListeners.push({node:i,name:s,handler:a})}}function i(t){var n=t.listen||[];u.listening=!0;for(var o=0;o<n.length;o++){var i=n[o],s=i.getNodeEvents||e("./listen/listen_by_"+i.name+".js").getNodeEvents,a=s(i,l);r(a,i,t)}}function s(t,n){var o=t.replay||[];u.listening=!1;for(var r=0;r<o.length;r++){var i=o[r],s=i.replayEvents||e("./replay/replay_after_"+i.name+".js").replayEvents;u.events=s(u.events,i,n,l)}}function a(e){var t,n;if(e.focus&&u.activeNode){var o=l.findClientNode(u.activeNode);o&&o.focus()}for(var r=0;r<u.eventListeners.length;r++)t=u.eventListeners[r],n=t.node,n.removeEventListener(t.name,t.handler);u.events=[]}var l=e("./dom"),u={eventListeners:[],events:[],listening:!1,activeNode:null};t.exports={state:u,getEventHandler:o,addEventListeners:r,startListening:i,replayEvents:s,cleanup:a}},{"./dom":2}],4:[function(e,t,n){function o(e){console.log("preboot options are:"),console.log(e)}function r(e){console.log("preboot events captured are:"),console.log(e)}function i(e,t,n){console.log("replaying:"),console.log({serverNode:e,clientNode:t,event:n})}function s(e){console.log("preboot could not find client node for:"),console.log(e)}function a(){if(arguments.length){var e=arguments[0]+"",t=l[e];if(t){var n=arguments.length>0?[].splice.call(arguments,1):[];t.apply(null,n)}}}var l={1:o,2:r,3:i,4:s};t.exports={log:a}},{}],5:[function(e,t,n){function o(){var e=c.opts;f(2,d.state.events),c.completeCalled=!0,c.canComplete&&(d.replayEvents(e,f),e.buffer&&p.switchBuffer(e),e.freeze&&c.freeze.cleanup(),d.cleanup(e))}function r(e){return function(){u.init({window:window}),u.updateRoots(u.getDocumentNode(e.appRoot)),e.buffer&&p.prep(e),e.freeze&&c.freeze.prep(e),d.startListening(e)}}function i(){c.canComplete=!1}function s(){return function(){c.canComplete=!0,c.completeCalled&&setTimeout(o,10)}}function a(t){c.opts=t,f(1,t),c.freeze="string"==typeof t.freeze?e("./freeze/freeze_with_"+t.freeze+".js"):t.freeze,u.init({window:window})}function l(){u.init({window:window}),u.state.body?r(c.opts)():u.onLoad(r(c.opts)),u.on(c.opts.pauseEvent,i),u.on(c.opts.resumeEvent,s())}var u=e("./dom"),d=e("./event_manager"),p=e("./buffer/buffer_manager"),f=e("./log").log||function(){},c={canComplete:!0,completeCalled:!1,freeze:null,opts:null};t.exports={eventManager:d,bufferManager:p,init:a,start:l,done:o}},{"./buffer/buffer_manager":1,"./dom":2,"./event_manager":3,"./log":4}]},{},[5])(5)}),preboot.init({appRoot:"app",replay:[{name:"rerender"}],freeze:"spinner",focus:!0,buffer:!0,keyPress:!0,uglify:!0,buttonPress:!0,pauseEvent:"PrebootPause",resumeEvent:"PrebootResume",freezeEvent:"PrebootFreeze",listen:[{name:"selectors",eventsBySelector:{'input[type="text"],textarea':["keypress","keyup","keydown"]}},{name:"selectors",eventsBySelector:{'input[type="text"],textarea':["focusin","focusout"]},trackFocus:!0,doNotReplay:!0},{name:"selectors",preventDefault:!0,eventsBySelector:{'input[type="submit"],button':["click"]},dispatchEvent:"PrebootFreeze"}],freezeStyles:{overlay:{className:"preboot-overlay",style:{position:"absolute",display:"none",zIndex:"9999999",top:"0",left:"0",width:"100%",height:"100%"}},spinner:{className:"preboot-spinner",style:{position:"absolute",display:"none",zIndex:"99999999"}}}});